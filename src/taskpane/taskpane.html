<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Outlook Add-in</title>
    <!-- Cache control meta tags (best effort for browsers) -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <link rel="stylesheet" href="styles.css">
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="../../images/mammoth.browser.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div id="app">
        <h1>Email 2 PDF</h1>
        <label for="pdfMode" style="display:block;margin-bottom:8px;font-weight:500;">PDF Generation Mode:</label>
        <select id="pdfMode" style="margin-bottom:16px;padding:4px 8px;font-size:1em;">
            <option value="full">Full PDF (email + attachments merged)</option>
            <option value="individual">Individual PDFs (email and each attachment)</option>
            <option value="images">Individual PDFs (attachments + each embedded image in email)</option>
        </select>
        <button id="convertBtn">Convert Email to PDF</button>
        <span id="version" style="font-size:0.9em;color:#888;">v1.3.2</span>
    </div>
    <div id="emailToPdfDiv" style="background:#fff; padding:24px; font-family:Arial, sans-serif; width:100%; max-width:794px; min-height:400px; margin:0 auto; box-sizing:border-box; display:none;"></div>
    <script>
      // You can update this version string in JS for easy control
      window.addinVersion = 'v1.3.2';
      document.querySelectorAll('#version').forEach(el => el.textContent = window.addinVersion);
    </script>
    <script src="taskpane.js"></script>
</body>
</html>